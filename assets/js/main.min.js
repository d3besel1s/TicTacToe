$(function(){var Players={playerOne:{symbol:"X",class:"player-one",number:1,score:0},playerTwo:{symbol:"O",class:"player-two",number:2,score:0}},currentPlayer=Players.playerOne,currentGameId=getGuid();function checkTurn(lastMove){var cells=getCells();checkRows(cells)||checkCols(cells)||checkDiag(cells)?showEndScreen(!0,cells,lastMove):isFullBoard(cells)?showEndScreen(!1,cells,lastMove):switchPlayer(cells,lastMove)}function showEndScreen(isGameWon,cells,lastMove){isGameWon?($(".message").text(`Player ${currentPlayer.number} has won!`),updateScore()):$(".message").text("Draw!"),$(".end-game-screen").show(),saveTurnData(cells,lastMove,isGameWon)}function switchPlayer(cells,lastMove){switch(saveTurnData(cells,lastMove,null),currentPlayer){case Players.playerOne:currentPlayer=Players.playerTwo;break;case Players.playerTwo:currentPlayer=Players.playerOne;break;default:console.log("Something went horribly wrong")}}function saveTurnData(cells,lastMove,isGameWon){isGameWon=null===isGameWon?"Game in progress":isGameWon?"A win":"A draw";var boardStatus=getBoardStatus(cells);$.post("../TicTacToe/handler/TurnHandler.php",{GameId:currentGameId,BoardStatus:boardStatus,LastMove:lastMove,Player:currentPlayer.number,GameStatus:isGameWon})}function getCells(){var cells=[];return $(".cells").each(function(){for(var values=[],i=0;i<this.children.length;i++)values.push(this.children[i].innerHTML);cells.push(values)}),cells}function checkRows(cells){return!!cells.some(row=>row.every(col=>col===currentPlayer.symbol))}function checkCols(cells){for(var col=0;col<cells[0].length;col++)if(cells[0][col]===currentPlayer.symbol&&cells[1][col]===currentPlayer.symbol&&cells[2][col]===currentPlayer.symbol)return!0;return!1}function checkDiag(cells){return cells[0][0]===currentPlayer.symbol&&cells[1][1]===currentPlayer.symbol&&cells[2][2]===currentPlayer.symbol||cells[0][2]===currentPlayer.symbol&&cells[1][1]===currentPlayer.symbol&&cells[2][0]===currentPlayer.symbol}function isFullBoard(cells){return cells.every(row=>row.every(col=>""!==col))}function updateScore(){currentPlayer.score++,$(`.${currentPlayer.class}-score`).text(currentPlayer.score)}function getBoardStatus(cells){for(var boardStatus="",i=0;i<cells.length;i++)for(var j=0;j<cells[i].length;j++)boardStatus+=cells[i][j]+";";return boardStatus}function getGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v;return("x"==c?r:3&r|8).toString(16)})}$(".cell").click(function(){var lastMove;""===this.innerHTML&&($(this).addClass(currentPlayer.class).append(currentPlayer.symbol),checkTurn($(this).data("cell-no")))}),$(".btn-restart").click(function(){$(".cell").each(function(){$(this).text("").removeClass(Players.playerOne.class+" "+Players.playerTwo.class)}),currentPlayer=Players.playerOne,currentGameId=getGuid(),$(".end-game-screen").hide()})});